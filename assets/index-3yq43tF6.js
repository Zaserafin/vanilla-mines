(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const I=["#c0c0c0","#0406F5","#0D7A09","#E90A03","#080272","#81020D","#008080","red","red"],h=document.getElementById("canvas-element"),a=h.getContext("2d"),y=document.getElementById("time-counter"),v=document.getElementById("flags-counter"),L=document.getElementById("reset-button");let p=null;const b=10,s=50,c=10,d=10,f={flagsUsed:0,seconds:0};let i=[];h.width=c*s;h.height=d*s;var M=new FontFace("tiny5","url(/vanilla-mines/Tiny5-Regular.ttf)");await M.load().then(function(e){document.fonts.add(e),console.log("Font loaded"),a.font="50px myFont"});function w(){y&&(f.seconds++,y.setHTMLUnsafe(f.seconds.toString().padStart(3,"0")))}function U(){let e;for(;;){let t=Math.floor(Math.random()*c),o=Math.floor(Math.random()*d);if(i[o][t].value!==-1){e={y:o,x:t};break}}return e}function F(){for(let e=0;e<d;e++){let t=[];for(let o=0;o<c;o++)t.push({value:0,status:"hidden"});i.push(t)}for(let e=0;e<b;e++){const{x:t,y:o}=U();i[o][t].value=-1;for(let l=-1;l<=1;l++)for(let n=-1;n<=1;n++){if(n===0&&l===0)continue;const r=t+n,u=o+l;if(r>=0&&r<c&&u>=0&&u<d){if(i[u][r].value===-1)continue;i[u][r].value=i[u][r].value+1}}}}function B(e,t){return e>=0&&e<i.length&&t>=0&&t<i[e].length}function S(e,t){if(!B(e,t))return;const o=i[e][t];if(!(o.status==="visible"||o.status==="flagged")&&(o.status="visible",o.value===0))for(let l=-1;l<=1;l++)for(let n=-1;n<=1;n++)l===0&&n===0||S(e+l,t+n)}function g(){for(let e=0;e<i.length;e++){const t=i[e];for(let o=0;o<t.length;o++){const l=t[o];l.status==="hidden"&&(a.fillStyle="#a1a1a1ff"),l.status==="flagged"&&(a.fillStyle="pink"),l.status==="visible"&&(a.fillStyle="#c0c0c0"),l.value===-1&&l.status==="visible"&&(a.fillStyle="red"),a.fillRect(e*s,o*s,c*s,d*s),l.value!==0&&l.status==="visible"&&(a.fillStyle=I[l.value],a.font="30px Tiny5",a.fillText(l.value.toString(),e*s+s/2-5,o*s+s/2+10))}}}function m(){for(let e=1;e<c;e++)a.fillStyle="#63615b",a.fillRect(e*s,0,2,d*s);for(let e=1;e<c;e++)a.fillStyle="#63615b",a.fillRect(0,e*s,c*s,2)}function P(){for(let e=0;e<d;e++)for(let t=0;t<c;t++){const o=i[e][t];o.status="visible"}}function x(){if(!v)return;const e=b-f.flagsUsed;v?.setHTMLUnsafe(e.toString().padStart(3,"0"))}function E(){i=[],F(),f.seconds=0,f.flagsUsed=0,x(),y&&y.setHTMLUnsafe(f.seconds.toString().padStart(3,"0")),p&&clearInterval(p),p=setInterval(w,1e3),g(),m()}a&&(a.fillStyle="#a1a1a1ff",a.fillRect(0,0,c*s,d*s),g(),m());L?.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),console.log("reseteando"),E()});document.addEventListener("contextmenu",e=>e.preventDefault());h.addEventListener("mousedown",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();const t=e.button===0,o=Math.floor(e.offsetY/s),l=Math.floor(e.offsetX/s),n=i[l][o];if(n.status!=="visible"){if(!t){n.status==="flagged"?(i[l][o].status="hidden",f.flagsUsed=Math.max(0,f.flagsUsed-1)):(i[l][o].status="flagged",f.flagsUsed=Math.max(0,f.flagsUsed+1)),x(),g(),m();return}if(t&&n.value===-1){console.log("Game Over ☠️"),p&&clearInterval(p),P(),g(),m();return}if(t&&n.value===0){S(l,o),g(),m();return}t&&(i[l][o].status="visible",g(),m())}});E();
