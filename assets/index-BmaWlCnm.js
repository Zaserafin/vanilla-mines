(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const L=["#c0c0c0","#0406F5","#0D7A09","#E90A03","#080272","#81020D","#008080","red","red"],y=document.getElementById("canvas-element"),i=y.getContext("2d"),p=document.getElementById("time-counter"),v=document.getElementById("flags-counter"),M=document.getElementById("reset-button");let h=null;const b=10,s=50,c=10,d=10,f={flagsUsed:0,seconds:0};let a=[];y.width=c*s;y.height=d*s;var I=new FontFace("tiny5","url(/vanilla-mines/Tiny5-Regular.ttf)");await I.load().then(function(e){document.fonts.add(e),console.log("Font loaded"),i.font="50px myFont"});function w(){p&&(f.seconds++,p.setHTMLUnsafe(f.seconds.toString().padStart(3,"0")))}function U(){let e;for(;;){let t=Math.floor(Math.random()*c),o=Math.floor(Math.random()*d);if(a[o][t].value!==-1){e={y:o,x:t};break}}return e}function F(){for(let e=0;e<d;e++){let t=[];for(let o=0;o<c;o++)t.push({value:0,status:"hidden"});a.push(t)}for(let e=0;e<b;e++){const{x:t,y:o}=U();a[o][t].value=-1;for(let l=-1;l<=1;l++)for(let n=-1;n<=1;n++){if(n===0&&l===0)continue;const r=t+n,u=o+l;if(r>=0&&r<c&&u>=0&&u<d){if(a[u][r].value===-1)continue;a[u][r].value=a[u][r].value+1}}}}function B(e,t){return e>=0&&e<a.length&&t>=0&&t<a[e].length}function S(e,t){if(!B(e,t))return;const o=a[e][t];if(!(o.status==="visible"||o.status==="flagged")&&(o.status="visible",o.value===0))for(let l=-1;l<=1;l++)for(let n=-1;n<=1;n++)l===0&&n===0||S(e+l,t+n)}function g(){for(let e=0;e<a.length;e++){const t=a[e];for(let o=0;o<t.length;o++){const l=t[o];l.status==="hidden"&&(i.fillStyle="#a1a1a1ff"),l.status==="flagged"&&(i.fillStyle="pink"),l.status==="visible"&&(i.fillStyle="#c0c0c0"),l.value===-1&&l.status==="visible"&&(i.fillStyle="red"),i.fillRect(e*s,o*s,c*s,d*s),l.value!==0&&l.status==="visible"&&(i.fillStyle=L[l.value],i.font="30px Tiny5",i.fillText(l.value.toString(),e*s+s/2-5,o*s+s/2+10))}}}function m(){for(let e=1;e<c;e++)i.fillStyle="#63615b",i.fillRect(e*s,0,2,d*s);for(let e=1;e<c;e++)i.fillStyle="#63615b",i.fillRect(0,e*s,c*s,2)}function P(){for(let e=0;e<d;e++)for(let t=0;t<c;t++){const o=a[e][t];o.status="visible"}}function x(){if(!v)return;const e=b-f.flagsUsed;v?.setHTMLUnsafe(e.toString().padStart(3,"0"))}function E(){F(),f.seconds=0,f.flagsUsed=0,x(),p&&p.setHTMLUnsafe(f.seconds.toString().padStart(3,"0")),h&&clearInterval(h),h=setInterval(w,1e3)}i&&(i.fillStyle="#a1a1a1ff",i.fillRect(0,0,c*s,d*s),g(),m());M?.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),E()});document.addEventListener("contextmenu",e=>e.preventDefault());y.addEventListener("mousedown",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();const t=e.button===0,o=Math.floor(e.offsetY/s),l=Math.floor(e.offsetX/s),n=a[l][o];if(n.status!=="visible"){if(!t){n.status==="flagged"?(a[l][o].status="hidden",f.flagsUsed=Math.max(0,f.flagsUsed-1)):(a[l][o].status="flagged",f.flagsUsed=Math.max(0,f.flagsUsed+1)),x(),g(),m();return}if(t&&n.value===-1){console.log("Game Over ☠️"),P(),g(),m();return}if(t&&n.value===0){S(l,o),g(),m();return}t&&(a[l][o].status="visible",g(),m())}});E();
