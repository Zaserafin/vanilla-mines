(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))t(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&t(d)}).observe(document,{childList:!0,subtree:!0});function o(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(l){if(l.ep)return;l.ep=!0;const i=o(l);fetch(l.href,i)}})();const E=["#c0c0c0","#0406F5","#0D7A09","#E90A03","#080272","#81020D","#008080","red","red"],v=document.getElementById("canvas-element"),a=v.getContext("2d"),y=document.getElementById("time-counter"),x=document.getElementById("flags-counter"),U=document.getElementById("reset-button");let h=null;const I=9,s=50,c=9,u=9,f={flagsUsed:0,seconds:0};let S=!1,r=Array.from({length:u},()=>Array.from({length:c},()=>({value:0,status:"hidden"})));v.width=c*s;v.height=u*s;var A=new FontFace("tiny5","url(/vanilla-mines/Tiny5-Regular.ttf)");await A.load().then(function(e){document.fonts.add(e),console.log("Font loaded"),a.font="50px myFont"});function w(){y&&(f.seconds++,y.setHTMLUnsafe(f.seconds.toString().padStart(3,"0")))}function F(e){let n;for(;;){let o=Math.floor(Math.random()*c),t=Math.floor(Math.random()*u);if(r[t][o].value!==-1&&o!==e?.x&&t!==e?.y){n={y:t,x:o};break}}return n}function B(e){for(let n=0;n<u;n++){let o=[];for(let t=0;t<c;t++)o.push({value:0,status:"hidden"});r.push(o)}for(let n=0;n<I;n++){const{x:o,y:t}=F(e);r[t][o].value=-1;for(let l=-1;l<=1;l++)for(let i=-1;i<=1;i++){if(i===0&&l===0)continue;const d=o+i,p=t+l;if(d>=0&&d<c&&p>=0&&p<u){if(r[p][d].value===-1)continue;r[p][d].value=r[p][d].value+1}}}}function T(e,n){return e>=0&&e<r.length&&n>=0&&n<r[e].length}function L(e,n){if(!T(e,n))return;const o=r[e][n];if(!(o.status==="visible"||o.status==="flagged")&&(o.status="visible",o.value===0))for(let t=-1;t<=1;t++)for(let l=-1;l<=1;l++)t===0&&l===0||L(e+t,n+l)}function g(){for(let e=0;e<r.length;e++){const n=r[e];for(let o=0;o<n.length;o++){const t=n[o];t.status==="hidden"&&(a.fillStyle="#a1a1a1ff"),t.status==="flagged"&&(a.fillStyle="pink"),t.status==="visible"&&(a.fillStyle="#c0c0c0"),t.value===-1&&t.status==="visible"&&(a.fillStyle="red"),a.fillRect(e*s,o*s,c*s,u*s),t.value!==0&&t.status==="visible"&&(a.fillStyle=E[t.value],a.font="30px Tiny5",a.fillText(t.value.toString(),e*s+s/2-5,o*s+s/2+10))}}}function m(){for(let e=1;e<c;e++)a.fillStyle="#63615b",a.fillRect(e*s,0,2,u*s);for(let e=1;e<c;e++)a.fillStyle="#63615b",a.fillRect(0,e*s,c*s,2)}function O(){for(let e=0;e<u;e++)for(let n=0;n<c;n++){const o=r[e][n];o.status="visible"}}function b(){if(!x)return;const e=I-f.flagsUsed;x?.setHTMLUnsafe(e.toString().padStart(3,"0"))}function P(e){S=!0,r=Array.from({length:u},()=>Array.from({length:c},()=>({value:0,status:"hidden"}))),console.log("Ignoring: ",e),B(e),f.seconds=0,f.flagsUsed=0,b(),y&&y.setHTMLUnsafe(f.seconds.toString().padStart(3,"0")),h&&clearInterval(h),h=setInterval(w,1e3),g(),m()}function M(){S=!1,f.seconds=0,f.flagsUsed=0,b(),y&&y.setHTMLUnsafe(f.seconds.toString().padStart(3,"0")),h&&clearInterval(h),r=Array.from({length:u},()=>Array.from({length:c},()=>({value:0,status:"hidden"}))),g(),m()}a&&(a.fillStyle="#a1a1a1ff",a.fillRect(0,0,c*s,u*s),g(),m());U?.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),console.log("reseteando"),M()});document.addEventListener("contextmenu",e=>e.preventDefault());v.addEventListener("mousedown",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();const n=e.button===0,o=Math.floor(e.offsetY/s),t=Math.floor(e.offsetX/s);S||P({x:o,y:t});const l=r[t][o];if(l.status!=="visible"){if(!n){l.status==="flagged"?(r[t][o].status="hidden",f.flagsUsed=Math.max(0,f.flagsUsed-1)):(r[t][o].status="flagged",f.flagsUsed=Math.max(0,f.flagsUsed+1)),b(),g(),m();return}if(n&&l.value===-1){console.log("Game Over ☠️"),h&&clearInterval(h),O(),g(),m();return}if(n&&l.value===0){L(t,o),g(),m();return}n&&(r[t][o].status="visible",g(),m())}});M();
