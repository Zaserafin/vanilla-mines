(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))t(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&t(d)}).observe(document,{childList:!0,subtree:!0});function n(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(l){if(l.ep)return;l.ep=!0;const i=n(l);fetch(l.href,i)}})();const E=["#c0c0c0","#0406F5","#0D7A09","#E90A03","#080272","#81020D","#008080","red","red"],v=document.getElementById("canvas-element"),a=v.getContext("2d"),y=document.getElementById("time-counter"),x=document.getElementById("flags-counter"),U=document.getElementById("reset-button");let h=null;const I=9,s=50,c=9,u=9,f={flagsUsed:0,seconds:0};let S=!1,r=Array.from({length:u},()=>Array.from({length:c},()=>({value:0,status:"hidden"})));v.width=c*s;v.height=u*s;var A=new FontFace("tiny5","url(/vanilla-mines/Tiny5-Regular.ttf)");await A.load().then(function(e){document.fonts.add(e),console.log("Font loaded"),a.font="50px myFont"});function w(){y&&(f.seconds++,y.setHTMLUnsafe(f.seconds.toString().padStart(3,"0")))}function F(e){let o;for(;;){let n=Math.floor(Math.random()*c),t=Math.floor(Math.random()*u);if(r[t][n].value!==-1&&n!==e?.x&&t!==e?.y){o={y:t,x:n};break}}return o}function B(e){for(let o=0;o<u;o++){let n=[];for(let t=0;t<c;t++)n.push({value:0,status:"hidden"});r.push(n)}for(let o=0;o<I;o++){const{x:n,y:t}=F(e);r[t][n].value=-1;for(let l=-1;l<=1;l++)for(let i=-1;i<=1;i++){if(i===0&&l===0)continue;const d=n+i,p=t+l;if(d>=0&&d<c&&p>=0&&p<u){if(r[p][d].value===-1)continue;r[p][d].value=r[p][d].value+1}}}}function T(e,o){return e>=0&&e<r.length&&o>=0&&o<r[e].length}function L(e,o){if(!T(e,o))return;const n=r[e][o];if(!(n.status==="visible"||n.status==="flagged"||n.value===-1)&&(n.status="visible",n.value===0))for(let t=-1;t<=1;t++)for(let l=-1;l<=1;l++)t===0&&l===0||L(e+t,o+l)}function g(){for(let e=0;e<r.length;e++){const o=r[e];for(let n=0;n<o.length;n++){const t=o[n];t.status==="hidden"&&(a.fillStyle="#a1a1a1ff"),t.status==="flagged"&&(a.fillStyle="pink"),t.status==="visible"&&(a.fillStyle="#c0c0c0"),t.value===-1&&t.status==="visible"&&(a.fillStyle="red"),a.fillRect(e*s,n*s,c*s,u*s),t.value!==0&&t.status==="visible"&&(a.fillStyle=E[t.value],a.font="30px Tiny5",a.fillText(t.value.toString(),e*s+s/2-5,n*s+s/2+10))}}}function m(){for(let e=1;e<c;e++)a.fillStyle="#63615b",a.fillRect(e*s,0,2,u*s);for(let e=1;e<c;e++)a.fillStyle="#63615b",a.fillRect(0,e*s,c*s,2)}function O(){for(let e=0;e<u;e++)for(let o=0;o<c;o++){const n=r[e][o];n.status="visible"}}function b(){if(!x)return;const e=I-f.flagsUsed;x?.setHTMLUnsafe(e.toString().padStart(3,"0"))}function P(e){S=!0,r=Array.from({length:u},()=>Array.from({length:c},()=>({value:0,status:"hidden"}))),console.log("Ignoring: ",e),B(e),f.seconds=0,f.flagsUsed=0,b(),y&&y.setHTMLUnsafe(f.seconds.toString().padStart(3,"0")),h&&clearInterval(h),h=setInterval(w,1e3),g(),m()}function M(){S=!1,f.seconds=0,f.flagsUsed=0,b(),y&&y.setHTMLUnsafe(f.seconds.toString().padStart(3,"0")),h&&clearInterval(h),r=Array.from({length:u},()=>Array.from({length:c},()=>({value:0,status:"hidden"}))),g(),m()}a&&(a.fillStyle="#a1a1a1ff",a.fillRect(0,0,c*s,u*s),g(),m());U?.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),console.log("reseteando"),M()});document.addEventListener("contextmenu",e=>e.preventDefault());v.addEventListener("mousedown",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();const o=e.button===0,n=Math.floor(e.offsetY/s),t=Math.floor(e.offsetX/s);S||P({x:n,y:t});const l=r[t][n];if(l.status!=="visible"){if(!o){l.status==="flagged"?(r[t][n].status="hidden",f.flagsUsed=Math.max(0,f.flagsUsed-1)):(r[t][n].status="flagged",f.flagsUsed=Math.max(0,f.flagsUsed+1)),b(),g(),m();return}if(o&&l.value===-1){console.log("Game Over ☠️"),h&&clearInterval(h),O(),g(),m();return}if(o&&l.value===0){L(t,n),g(),m();return}o&&(r[t][n].status="visible",g(),m())}});M();
